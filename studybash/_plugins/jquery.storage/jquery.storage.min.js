!function(a){a.storage=function(){var c={BASE:""},d=function(a){return a&&a.length&&0===a.indexOf(c.BASE)?a.substr(c.BASE.length):a},e=function(){try{var a="localStorage"in window&&null!==window.localStorage;if(!a)throw new Error("local_storage_support: failed");return!0}catch(b){return!1}},f=function(){function a(a){for(var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",c="",d=0;a>d;d++)c+=b.charAt(Math.floor(Math.random()*b.length));return c}var b=this.keys(),c=null;do{c=a(40)+".";var d=_.find(b,function(a){return-1!==a.indexOf(c)})}while(d);var e=new Array(1025).join("a"),f=0,g=null;do g=this.set(c+f,e),f++;while(g);for(var h=f-1;h>=0;h--)this.remove(c+h);return e=null,b=null,c=null,f},g=function(){for(var a=window.localStorage,b=[],c=0;c<a.length;c++)b.push(d(a.key(c)));return b},h=function(a){if(a)window.localStorage.clear();else{var b=this.keys();for(x=0;x<b.length;x++){var d=b[x];d&&d.length&&0===d.indexOf(c.BASE)&&this.remove(d)}}},i=function(b,d){var e=window.localStorage,f=e.removeItem(d?b:c.BASE+b);return"undefined"!==a.gettype(f).base},j=function(b){var d=window.localStorage;return"undefined"!==a.gettype(d[c.BASE+b]).base},k=function(a){var b=window.localStorage;return this.has(a)?JSON.parse(b.getItem(c.BASE+a)):void 0},l=function(a,b){var d=window.localStorage,e=!0,f=[],g=function(a,b){if("object"==typeof b&&null!==b){if(-1!==f.indexOf(b))return"$.jquery.storage:[endless recursion]";f.push(b)}return b};try{d.setItem(c.BASE+a,JSON.stringify(b,g))}catch(h){e=!1}return f=null,e},m=function(b){a(window).on("storage",function(a){b(a)})};return{settings:c,supported:e,onStorageChange:m,getCapacityInKb:f,keys:g,clear:h,remove:i,has:j,get:k,set:l}}()}(jQuery);